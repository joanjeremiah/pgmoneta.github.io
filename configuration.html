---
layout: default
---

<div id="home">
    <h1>
        {% for header in site.headers %}
        <a class="header" href="{{ header.url }}">{{ header.name }}</a>
        {% endfor %}
    </h1>
    <p/>

    <h2>pgmoneta.conf</h2>

    <h3>[pgmoneta]</h3>

    Main configuration of pgmoneta.
    <p/>
    
    <table border="1">
      <thead>
        <th align="left">Property</th>
        <th align="left">Default</th>
        <th align="left">Unit</th>
        <th align="left">Required</th>
        <th align="left">Description</th>
      </thead>
      <tbody>
        <tr>
          <td>host</td>
          <td></td>
          <td>String</td>
          <td>Yes</td>
          <td>The bind address for pgmoneta</td>
        </tr>
        <tr>
          <td>unix_socket_dir</td>
          <td></td>
          <td>String</td>
          <td>Yes</td>
          <td>The Unix Domain Socket location</td>
        </tr>
        <tr>
          <td>base_dir</td>
          <td></td>
          <td>String</td>
          <td>Yes</td>
          <td>The base directory for pgmoneta</td>
        </tr>
        <tr>
          <td>pgsql_dir</td>
          <td></td>
          <td>String</td>
          <td>Yes</td>
          <td>The path for the PostgreSQL command line tools</td>
        </tr>
        <tr>
          <td>metrics</td>
          <td>0</td>
          <td>Int</td>
          <td>No</td>
          <td>The metrics port (disable = 0)</td>
        </tr>
        <tr>
          <td>management</td>
          <td>0</td>
          <td>Int</td>
          <td>No</td>
          <td>The remote management port (disable = 0)</td>
        </tr>
        <tr>
          <td>compression</td>
          <td>zstd</td>
          <td>String</td>
          <td>No</td>
          <td>The compression type (none, gzip, zstd)</td>
        </tr>
        <tr>
          <td>compression_level</td>
          <td>3</td>
          <td>Int</td>
          <td>No</td>
          <td>The compression level</td>
        </tr>
        <tr>
          <td>retention</td>
          <td>7</td>
          <td>Int</td>
          <td>No</td>
          <td>The retention time in days</td>
        </tr>
        <tr>
          <td>link</td>
          <td>on</td>
          <td>Bool</td>
          <td>No</td>
          <td>Use links to limit backup size</td>
        </tr>
        <tr>
          <td>log_type</td>
          <td>console</td>
          <td>String</td>
          <td>No</td>
          <td>The logging type (console, file, syslog)</td>
        </tr>
        <tr>
          <td>log_level</td>
          <td>info</td>
          <td>String</td>
          <td>No</td>
          <td>The logging level (fatal, error, warn, info, debug1, ..., debug5)</td>
        </tr>
        <tr>
          <td>log_path</td>
          <td>pgmoneta.log</td>
          <td>String</td>
          <td>No</td>
          <td>The log file location</td>
        </tr>
        <tr>
          <td>blocking_timeout</td>
          <td>30</td>
          <td>Int</td>
          <td>No</td>
          <td>The number of seconds the process will be blocking for a connection (disable = 0)</td>
        </tr>
        <tr>
          <td>tls</td>
          <td>off</td>
          <td>Bool</td>
          <td>No</td>
          <td>Enable Transport Layer Security (TLS)</td>
        </tr>
        <tr>
          <td>tls_cert_file</td>
          <td></td>
          <td>String</td>
          <td>No</td>
          <td>Certificate file for TLS. This file must be owned by either the user running pgmoneta or root</td>
        </tr>
        <tr>
          <td>tls_key_file</td>
          <td></td>
          <td>String</td>
          <td>No</td>
          <td>Private key file for TLS. This file must be owned by either the user running pgmoneta or root.
            Additionally permissions must be at least 0640 when owned by root or 0600 otherwise.</td>
        </tr>
        <tr>
          <td>tls_ca_file</td>
          <td></td>
          <td>String</td>
          <td>No</td>
          <td>Certificate Authority (CA) file for TLS. This file must be owned by either the user running pgmoneta or root</td>
        </tr>
        <tr>
          <td>libev</td>
          <td>auto</td>
          <td>String</td>
          <td>No</td>
          <td>Select the <a href="http://software.schmorp.de/pkg/libev.html">libev</a> backend to use. Valid options: auto, select, poll, epoll, iouring, devpoll and port</td>
        </tr>
        <tr>
          <td>buffer_size</td>
          <td>65535</td>
          <td>Int</td>
          <td>No</td>
          <td>The network buffer size (SO_RCVBUF and SO_SNDBUF)</td>
        </tr>
        <tr>
          <td>keep_alive</td>
          <td>on</td>
          <td>Bool</td>
          <td>No</td>
          <td>Have SO_KEEPALIVE on sockets</td>
        </tr>
        <tr>
          <td>nodelay</td>
          <td>on</td>
          <td>Bool</td>
          <td>No</td>
          <td>Have TCP_NODELAY on sockets</td>
        </tr>
        <tr>
          <td>non_blocking</td>
          <td>on</td>
          <td>Bool</td>
          <td>No</td>
          <td>Have O_NONBLOCK on sockets</td>
        </tr>
        <tr>
          <td>backlog</td>
          <td>max_connections / 4</td>
          <td>Int</td>
          <td>No</td>
          <td>The backlog for listen(). Minimum 16</td>
        </tr>
        <tr>
          <td>hugepage</td>
          <td>try</td>
          <td>String</td>
          <td>No</td>
          <td>Huge page support (off, try, on)</td>
        </tr>
        <tr>
          <td>pidfile</td>
          <td></td>
          <td>String</td>
          <td>No</td>
          <td>Path to the PID file</td>
        </tr>
      </tbody>
    </table>

    <p/>
      
    <h3>Server section</h3>

    Specifies the PostgreSQL instances.
    <p/>

    <table border="1">
      <thead>
        <th align="left">Property</th>
        <th align="left">Default</th>
        <th align="left">Unit</th>
        <th align="left">Required</th>
        <th align="left">Description</th>
      </thead>
      <tbody>
        <tr>
          <td>host</td>
          <td></td>
          <td>String</td>
          <td>Yes</td>
          <td>The address of the PostgreSQL instance</td>
        </tr>
        <tr>
          <td>port</td>
          <td></td>
          <td>Int</td>
          <td>Yes</td>
          <td>The port of the PostgreSQL instance</td>
        </tr>
        <tr>
          <td>user</td>
          <td></td>
          <td>String</td>
          <td>Yes</td>
          <td>The replication user name</td>
        </tr>
        <tr>
          <td>backup_slot</td>
          <td></td>
          <td>String</td>
          <td>No</td>
          <td>The replication slot for the backup</td>
        </tr>
        <tr>
          <td>wal_slot</td>
          <td></td>
          <td>String</td>
          <td>No</td>
          <td>The replication slot for WAL</td>
        </tr>
        <tr>
          <td>follow</td>
          <td></td>
          <td>String</td>
          <td>No</td>
          <td>Failover to this server if follow server fails</td>
        </tr>
        <tr>
          <td>retention</td>
          <td></td>
          <td>Int</td>
          <td>No</td>
          <td>The retention time for the server</td>
        </tr>
        <tr>
          <td>synchronous</td>
          <td>off</td>
          <td>Bool</td>
          <td>No</td>
          <td>Use synchronous receive</td>
        </tr>
      </tbody>
    </table>

    <p/>
    The configuration is loaded from either the path specified by the -c flag or /etc/pgmoneta/pgmoneta.conf.

    <h3>Example</h3>

    <pre>
[pgmoneta]
host = *
metrics = 5001

base_dir = /home/pgmoneta

compression = zstd

retention = 7

log_type = file
log_level = info
log_path = /tmp/pgmoneta.log

unix_socket_dir = /tmp/
pgsql_dir = /usr/bin/

[primary]
host = localhost
port = 5432
user = repl
    </pre>

    <h2>pgmoneta_users.conf</h2>

    The pgmoneta_users configuration defines the users known to the system. This file is created and managed through
    the pgmoneta-admin tool.
    <p/>
    The configuration is loaded from either the path specified by the -u flag or /etc/pgmoneta/pgmoneta_users.conf.

    <h2>pgmoneta_admins.conf</h2>

    The pgmoneta_admins configuration defines the administrators known to the system. This file is created and managed through
    the pgmoneta-admin tool.
    <p/>
    The configuration is loaded from either the path specified by the -A flag or /etc/pgmoneta/pgmoneta_admins.conf.
    <p/>

    If pgmoneta has both Transport Layer Security (TLS) and "management" enabled then pgmoneta-cli can
    connect with TLS using the files ~/.pgmoneta/pgmoneta.key (must be 0600 permission),
    ~/.pgmoneta/pgmoneta.crt and ~/.pgmoneta/root.crt.

</div>
